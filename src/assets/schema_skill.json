{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$defs": {
    "unitType": {
      "enum": [ "ソルジャー", "ランサー", "ライダー", "エアリアル", "ソーサラー", "セイント", "シューター", "アサシン", "ヴォイド" ]
    },
    "symbolType": {
      "enum": [ "ゼニス", "オリジン", "ナディア" ]
    },
    "supportlType": {
      "enum": [ "支援", "攻撃", "妨害" ]
    },
    "rarityType": {
      "enum": [ "N", "R", "SR", "SSR" ]
    },
    "damageType": {
      "enum": [ "アタック", "マジック" ]
    },
    "equipType": {
      "enum": [ "武器", "鎧", "兜", "アクセサリ", "月のアミュレット", "太陽のアミュレット" ]
    },
    "amuletType": {
      "enum": [ "月", "太陽" ]
    },
    "targetType": {
      "enum": [ "自身", "自ユニット", "単体", "複数", "全体" ]
    },

    "timingType": {
      "enum": [
        "ターン開始時",
        "戦闘前",
        "戦闘後",
        "行動後",
        "ターン終了時",

        "スキル前",
        "スキル後",
        "攻撃前",
        "攻撃後",
        "敵撃破時",

        "永続"
      ]
    },
    "effectType": {
      "enum": [
        "最大HP",
        "アタック",
        "ディフェンス",
        "マジック",
        "レジスト",
        "テクニック",
        "ディフェンス無視",
        "レジスト無視",
        "与ダメージ",
        "与ダメージ(物理)",
        "与ダメージ(魔法)",
        "与ダメージ(スキル)",
        "与ダメージ(範囲スキル)",
        "与ダメージ(通常攻撃)",
        "ダメージ耐性",
        "ダメージ耐性(物理)",
        "ダメージ耐性(魔法)",
        "ダメージ耐性(範囲)",
        "クリティカル率",
        "クリティカル率耐性",
        "クリティカルダメージ倍率",
        "治療効果",
        "被治療効果",
        "射程(通常攻撃)",
        "射程(スキル)",
        "範囲",
        "移動",
        "移動コスト1化",
        "ランダム",

        "スタン",
        "アクティブスキル使用不可",
        "パッシブスキル使用不可",
        "ガード不可",
        "強化不可",
        "回復不可",
        "DoT",
        "全デバフ(アクティブ由来)",
        "固定ダメージ(アクティブ由来)",
        "アタックダウン",
        "ディフェンスダウン",
        "マジックダウン",
        "レジストダウン",
        "移動ダウン",
        "位置移動"
      ]
    },
    "conditionVariable": {
      "enum": [
        "token",
        "moveAmount",
        "activeBuffCount"
      ]
    },
    "numericCompare": {
      "type": "array",
      "items": {
        "anyOf": [
          { "enum": [ ">", "<", ">=", "<=", "==" ] },
          { "enum": [ "target" ] },
          { "type": "number" },
          {
            "type": "array",
            "items": { "type": "number" }
          }
        ]
      },
      "minItems": 2,
      "maxItems": 2
    },
    "unitsInArea": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "area": { "type": "integer" },
        "shape": { "enum": [ "範囲", "周囲" ] },
        "compare": { "$ref": "#/$defs/numericCompare" }
      },
    },

    "condition": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "onCloseCombat": { "type": "boolean" },
        "onRangedCombat": { "type": "boolean" },
        "onCriticalHit": { "type": "boolean" },
        "onGuard": { "type": "boolean" },
        "onMove": { "type": "boolean" },
        "onDamage": { "type": "boolean" },
        "onKill": { "type": "boolean" },
        "onSingleSkill": { "type": "boolean" },
        "onAreaSkill": { "type": "boolean" },
        "onOwnTurn": { "type": "boolean" },
        "onEnemyTurn": { "type": "boolean" },
        "onNearAlly": { "type": [ "number", "string" ] },
        "onNoNearAlly": { "type": [ "number", "string" ] },
        "onNearEnemy": { "type": [ "number", "string" ] },
        "onNoNearEnemy": { "type": [ "number", "string" ] },
        "onSymbol": {
          "type": "array",
          "uniqueItems": true,
          "items": { "$ref": "#/$defs/symbolType" }
        },
        "onClass": {
          "type": "array",
          "uniqueItems": true,
          "items": { "$ref": "#/$defs/unitType" }
        },
        "onEnemyClass": {
          "type": "array",
          "uniqueItems": true,
          "items": { "$ref": "#/$defs/unitType" }
        },
        "onClassAdvantage": { "type": "boolean" },
        "onEffect": { "type": "string" },

        "probability": { "type": [ "number", "array" ] },
        "hp": { "$ref": "#/$defs/numericCompare" },
        "targetHp": { "$ref": "#/$defs/numericCompare" },
        "turn": { "$ref": "#/$defs/numericCompare" },
        "token": { "$ref": "#/$defs/numericCompare" },
        "activeBuffCount": { "$ref": "#/$defs/numericCompare" },
        "activeDebuffCount": { "$ref": "#/$defs/numericCompare" },
        "targetActiveBuffCount": { "$ref": "#/$defs/numericCompare" },
        "targetActiveDebuffCount": { "$ref": "#/$defs/numericCompare" },
        "nearAllyCount": { "$ref": "#/$defs/unitsInArea" },
        "nearEnemyCount": { "$ref": "#/$defs/unitsInArea" }
      }
    },

    "effect": {
      "type": "object",
      "required": [ "type" ],
      "additionalProperties": false,
      "properties": {
        "type": { "$ref": "#/$defs/effectType" },
        "value": { "type": [ "number", "array" ] },
        "maxStack": { "type": "number" },
        "stackBy": { "$ref": "#/$defs/conditionVariable" },
        "duration": { "type": [ "number", "array" ] },
        "ephemeral": { "type": "boolean" },
        "target": { "$ref": "#/$defs/targetType" },
        "area": { "type": [ "number", "string" ] },
        "amount": { "type": [ "number", "string" ] },
        "variant": { "type": [ "number", "string" ] },
        "slot": { "type": "string" },
        "timing": { "$ref": "#/$defs/timingType" },
        "condition": { "$ref": "#/$defs/condition" }
      }
    }
  },
  "type": "array",
  "items": {
    "type": "object",
    "required": [ "uid", "icon", "name" ],
    "additionalProperties": false,
    "properties": {
      "uid": { "type": "string" },
      "icon": { "type": "string" },
      "name": { "type": "string" },
      "desc": { "type": "string" },
      "descs": { "type": "object" },
      "ct": { "type": [ "integer", "string" ] },
      "area": { "type": [ "integer", "string" ] },
      "range": { "type": [ "integer", "string" ] },
      "cost": { "type": "integer" },
      "damageRate": { "type": "number" },
      "damageRateSp": {
        "type": "object",
        "required": [ "value", "condition" ],
        "additionalProperties": false,
        "properties": {
          "value": { "type": "number" },
          "condition": { "$ref": "#/$defs/condition" }
        }
      },
      "healRate": { "type": [ "number", "object" ] },
      "summon": { "type": [ "array" ] },
      "buff": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "debuff": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "immune": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "statusEffects": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "tags": {
        "type": "array",
        "items": { "type": "string" }
      },
      "note": { "type": "string" }
    }
  }
}

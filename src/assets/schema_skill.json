{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$defs": {
    "unitType": {
      "enum": [ "ソルジャー", "ランサー", "ライダー", "エアリアル", "ソーサラー", "セイント", "シューター", "アサシン", "ヴォイド" ]
    },
    "symbolType": {
      "enum": [ "ゼニス", "オリジン", "ナディア" ]
    },
    "supportlType": {
      "enum": [ "支援", "攻撃", "妨害" ]
    },
    "rarityType": {
      "enum": [ "N", "R", "SR", "SSR" ]
    },
    "statusType": {
      "enum": [ "最大HP", "アタック", "ディフェンス", "マジック", "レジスト", "テクニック" ]
    },
    "damageType": {
      "enum": [ "アタック", "マジック" ]
    },
    "equipType": {
      "enum": [ "武器", "鎧", "兜", "アクセサリ", "月のアミュレット", "太陽のアミュレット" ]
    },
    "amuletType": {
      "enum": [ "月", "太陽" ]
    },
    "terrainType": {
      "enum": [ "平地", "草原", "森", "水中", "荒地", "崖", "空", "山岳", "洞窟", "砂地", "砂丘", "積雪", "置物", "砦", "壁", "柵", "溶岩" ]
    },
    "targetEnum": {
      "enum": [ "自身", "自身(メイン)", "自身(サポート)", "単体", "複数", "スキル対象", "全体" ]
    },
    "targetType": {
      "anyOf": [
        { "$ref": "#/$defs/targetEnum" },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "uid": { "type": "string" }
          }
        }
      ]
    },

    "timingType": {
      "enum": [
        "永続",
        "ターン開始時",
        "戦闘前",
        "戦闘後",
        "行動後",
        "ターン終了時",

        "スキル前",
        "スキル後",
        "攻撃前",
        "攻撃後",
        "敵撃破時",
        "死亡時",
        "復活時"
      ]
    },
    "effectType": {
      "enum": [
        "最大HP",
        "アタック",
        "ディフェンス",
        "マジック",
        "レジスト",
        "テクニック",
        "ディフェンス無視",
        "レジスト無視",
        "与ダメージ",
        "与ダメージ(物理)",
        "与ダメージ(魔法)",
        "与ダメージ(スキル)",
        "与ダメージ(範囲スキル)",
        "与ダメージ(通常攻撃)",
        "ダメージ耐性",
        "ダメージ耐性(物理)",
        "ダメージ耐性(魔法)",
        "ダメージ耐性(範囲)",
        "クリティカル率",
        "クリティカル率耐性",
        "クリティカルダメージ倍率",
        "治療効果",
        "被治療効果",
        "射程(通常攻撃)",
        "射程(スキル)",
        "範囲",
        "移動",
        "移動コスト1化",
        "ランダム",
        "シールド",
        "トークン",

        "スタン",
        "アクティブスキル使用不可",
        "パッシブスキル使用不可",
        "ガード不可",
        "強化不可",
        "回復不可",
        "DoT",
        "全デバフ(アクティブ由来)",
        "固定ダメージ(アクティブ由来)",
        "アタックダウン",
        "ディフェンスダウン",
        "マジックダウン",
        "レジストダウン",
        "移動ダウン",
        "位置移動"
      ]
    },
    "conditionVariable": {
      "enum": [
        "token",
        "targetToken",
        "moveAmount",
        "range",
        "nearAllyCount",
        "nearEnemyCount",
        "activeBuffCount",
        "activeDebuffCount",
        "targetActiveBuffCount",
        "targetActiveDebuffCount"
      ]
    },
    "numericCompare": {
      "type": "array",
      "items": {
        "anyOf": [
          { "enum": [ ">", "<", ">=", "<=", "==" ] },
          { "enum": [ "target" ] },
          { "type": "number" },
          {
            "type": "array",
            "items": { "type": "number" }
          }
        ]
      },
      "minItems": 2,
      "maxItems": 2
    },
    "areaShape": {
      "enum": [ "範囲", "周囲", "直線" ]
    },
    "areaCenter": {
      "enum": [ "自分中心", "中心指定" ]
    },
    "areaType": {
      "anyOf": [
        { "type": "number" },
        {
          "type": "array",
          "items": { "type": "number" }
        },
        {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "anyOf": [
                  { "type": "number" },
                  {
                    "type": "array",
                    "items": { "type": "number" }
                  }
                ]
              },
              { "$ref": "#/$defs/areaShape" },
              { "$ref": "#/$defs/areaCenter" },
              { "enum": [ "自身を含む", "自身を除く" ] }
            ]
          }
        }
      ]
    },
    "unitsInArea": {
      "type": "object",
      "required": [ "area", "compare" ],
      "additionalProperties": false,
      "properties": {
        "area": { "$ref": "#/$defs/areaType" },
        "compare": { "$ref": "#/$defs/numericCompare" }
      }
    },
    "statusConversion": {
      "type": "object",
      "required": [ "from", "rate" ],
      "properties": {
        "from": { "$ref": "#/$defs/statusType" },
        "rate": {
          "anyOf": [
            { "type": "number" },
            {
              "type": "array",
              "items": { "type": "number" }
            }
          ]
        }
      }
    },
    "variableStatusRate": {
      "type": "object",
      "required": [ "min", "max", "by", "order" ],
      "properties": {
        "min": {
          "anyOf": [
            { "type": "number" },
            {
              "type": "array",
              "items": { "type": "number" }
            }
          ]
        },
        "max": {
          "anyOf": [
            { "type": "number" },
            {
              "type": "array",
              "items": { "type": "number" }
            }
          ]
        },
        "by": { "enum": [ "HP" ] },
        "order": { "enum": [ "多いほど上昇", "低いほど上昇" ] },
        "borders": {
          "type": "array",
          "items": { "type": "number" }
        }
      }
    },

    "condition": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "onCloseCombat": { "type": "boolean" },
        "onRangedCombat": { "type": "boolean" },
        "onCriticalHit": { "type": "boolean" },
        "onBattle": { "type": "boolean" },
        "onGuard": { "type": "boolean" },
        "onDamage": { "type": "boolean" },
        "onKill": { "type": "boolean" },
        "onActiveSkill": { "type": "boolean" },
        "onSingleSkill": { "type": "boolean" },
        "onAreaSkill": { "type": "boolean" },
        "onOwnTurn": { "type": "boolean" },
        "onEnemyTurn": { "type": "boolean" },
        "onSymbol": {
          "type": "array",
          "uniqueItems": true,
          "items": { "$ref": "#/$defs/symbolType" }
        },
        "onClass": {
          "type": "array",
          "uniqueItems": true,
          "items": { "$ref": "#/$defs/unitType" }
        },
        "onEnemyClass": {
          "type": "array",
          "uniqueItems": true,
          "items": { "$ref": "#/$defs/unitType" }
        },
        "onClassAdvantage": { "type": "boolean" },
        "onEffect": { "type": "string" },
        "onTerrain": {
          "type": "array",
          "uniqueItems": true,
          "items": { "$ref": "#/$defs/terrainType" }
        },

        "probability": { "type": [ "number", "array" ] },
        "hp": { "$ref": "#/$defs/numericCompare" },
        "mainHp": { "$ref": "#/$defs/numericCompare" },
        "supportHp": { "$ref": "#/$defs/numericCompare" },
        "targetHp": { "$ref": "#/$defs/numericCompare" },
        "turn": { "$ref": "#/$defs/numericCompare" },
        "token": { "$ref": "#/$defs/numericCompare" },
        "targetToken": { "$ref": "#/$defs/numericCompare" },
        "activeBuffCount": { "$ref": "#/$defs/numericCompare" },
        "activeDebuffCount": { "$ref": "#/$defs/numericCompare" },
        "targetActiveBuffCount": { "$ref": "#/$defs/numericCompare" },
        "targetActiveDebuffCount": { "$ref": "#/$defs/numericCompare" },
        "terrainDef": { "$ref": "#/$defs/numericCompare" },
        "nearAllyCount": { "$ref": "#/$defs/unitsInArea" },
        "nearEnemyCount": { "$ref": "#/$defs/unitsInArea" }
      }
    },

    "effect": {
      "type": "object",
      "required": [ "type" ],
      "additionalProperties": false,
      "properties": {
        "type": { "$ref": "#/$defs/effectType" },
        "value": { "type": [ "number", "array" ] },
        "maxStack": { "type": "number" },
        "stackBy": {
          "anyOf": [
            { "$ref": "#/$defs/conditionVariable" },
            {
              "type": "array",
              "items": {
                "anyOf": [
                  { "$ref": "#/$defs/conditionVariable" },
                  { "$ref": "#/$defs/areaType" }
                ]
              }
            }
          ]
        },
        "add": { "$ref": "#/$defs/statusConversion" },
        "replace": { "$ref": "#/$defs/statusConversion" },
        "variable": { "$ref": "#/$defs/variableStatusRate" },
        "duration": { "type": [ "number", "array" ] },
        "ephemeral": { "type": "boolean" },
        "target": { "$ref": "#/$defs/targetType" },
        "area": { "$ref": "#/$defs/areaType" },
        "amount": { "type": [ "number", "string" ] },
        "variant": { "type": [ "number", "string" ] },
        "slot": { "type": "string" },
        "timing": { "$ref": "#/$defs/timingType" },
        "condition": { "$ref": "#/$defs/condition" }
      }
    },

    "fixedDamage": {
      "type": "object",
      "required": [ "base", "value" ],
      "additionalProperties": false,
      "properties": {
        "base": {
          "anyOf": [
            { "$ref": "#/$defs/statusType" },
            { "enum": [ "与ダメージ" ] }
          ]
        },
        "rate": { "type": [ "number", "array" ] },
        "maxStack": { "type": "number" },
        "stackBy": {
          "anyOf": [
            { "$ref": "#/$defs/conditionVariable" },
            {
              "type": "array",
              "items": {
                "anyOf": [
                  { "$ref": "#/$defs/conditionVariable" },
                  { "$ref": "#/$defs/areaType" }
                ]
              }
            }
          ]
        },
        "target": { "$ref": "#/$defs/targetType" },
        "area": { "$ref": "#/$defs/areaType" },
        "timing": { "$ref": "#/$defs/timingType" },
        "condition": { "$ref": "#/$defs/condition" }
      }
    },

    "multiMove": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "enum": [ "基本移動力", "残移動力", "固定値移動力" ] },
        "value": { "type": "number" },
        "condition": { "$ref": "#/$defs/condition" }
      }
    }

  },
  "type": "array",
  "items": {
    "type": "object",
    "required": [ "uid", "icon", "name" ],
    "additionalProperties": false,
    "properties": {
      "uid": { "type": "string" },
      "icon": { "type": "string" },
      "name": { "type": "string" },
      "desc": { "type": "string" },
      "descs": { "type": "object" },
      "ct": { "type": [ "integer", "string" ] },
      "area": { "type": [ "integer", "string" ] },
      "areaShape": { "$ref": "#/$defs/areaShape" },
      "range": { "type": [ "integer", "string" ] },
      "cost": { "type": "integer" },
      "isNormalAttack": { "type": "boolean" },
      "isSymbolSkill": { "type": "boolean" },
      "damageRate": {
        "anyOf": [
          { "type": "number" },
          {
            "type": "array",
            "items": { "type": "number" }
          }
        ]
      },
      "damageRateSp": {
        "type": "object",
        "required": [ "value", "condition" ],
        "additionalProperties": false,
        "properties": {
          "value": {
            "anyOf": [
              { "type": "number" },
              {
                "type": "array",
                "items": { "type": "number" }
              }
            ]
          },
          "condition": { "$ref": "#/$defs/condition" }
        }
      },
      "fixedDamage": {
        "type": "array",
        "items": { "$ref": "#/$defs/fixedDamage" }
      },
      "healRate": { "type": [ "number", "object" ] },
      "summon": { "type": [ "array" ] },
      "baseStatusBoost": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "hp": { "type": "number" },
          "atk": { "type": "number" },
          "def": { "type": "number" },
          "mag": { "type": "number" },
          "res": { "type": "number" },
          "tec": { "type": "number" },
          "cri": { "type": "number" }
        }
      },
      "buff": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "debuff": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "immune": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "statusEffects": {
        "type": "array",
        "items": { "$ref": "#/$defs/effect" }
      },
      "buffCancel": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "value": {
            "anyOf": [
              { "type": "number" },
              {
                "type": "array",
                "items": { "type": "number" }
              }
            ]
          },
          "timing": { "$ref": "#/$defs/timingType" },
          "condition": { "$ref": "#/$defs/condition" }
        }
      },
      "buffSteal": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "value": {
            "anyOf": [
              { "type": "number" },
              {
                "type": "array",
                "items": { "type": "number" }
              }
            ]
          },
          "timing": { "$ref": "#/$defs/timingType" },
          "condition": { "$ref": "#/$defs/condition" }
        }
      },
      "doubleAttack": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "coolDown": {
            "anyOf": [
              { "type": "number" },
              {
                "type": "array",
                "items": { "type": "number" }
              }
            ]
          },
          "condition": { "$ref": "#/$defs/condition" }
        }
      },
      "multiMove": {
        "$ref": "#/$defs/multiMove"
      },
      "multiAction": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "target": { "$ref": "#/$defs/targetEnum" },
          "coolDown": {
            "anyOf": [
              { "type": "number" },
              {
                "type": "array",
                "items": { "type": "number" }
              }
            ]
          },
          "condition": { "$ref": "#/$defs/condition" }
        }
      },
      "tags": {
        "type": "array",
        "items": { "type": "string" }
      },
      "note": { "type": "string" }
    }
  }
}
